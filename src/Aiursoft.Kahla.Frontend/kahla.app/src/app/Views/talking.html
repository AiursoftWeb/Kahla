<app-header
    [returnButton]="true"
    [shadow]="true"
    [closeDirectly]="true"
    [processing]="!repo || !repo.health"
    [title]="threadInfo.value() | threadName"
    [button]="true"
    buttonIcon="fas fa-ellipsis"
    [buttonLink]="'/thread/' + id()"
    [repo]="repo"
/>
@if (hasMoreMessages()) {
    <app-load-more-button
        [reversedDirection]="true"
        [autoLoad]="true"
        [loading]="loadingMessages()"
        [disabled]="!hasMoreMessages()"
        (requestLoadMore)="loadMoreMessages()"
    />
}
<app-message-list
    [messages]="parsedMessages()"
    [lastReadIndex]="threadInfo.value()?.messageContext?.unReadAmount ?? 0"
    [pulledIndex]="pulledIndex()"
    [pushedIndex]="pushedIndex()"
    (mention)="talkingInput.mention($event)"
/>
<app-scroll-button
    id="scrollDown"
    direction="down"
    [emphasis]="hasNewMessages()"
    [ngClass]="{ 'active-button': showPanel() }"
/>
<app-talking-input
    #talkingInput
    [(showPanel)]="showPanel"
    [threadInfo]="this.threadInfo.value()"
    (sendMessage)="send($event)"
/>
